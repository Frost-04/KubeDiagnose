# Bad Service Configuration
# This manifest creates a service with intentional misconfigurations:
# 1. Service selector doesn't match any pod
# 2. Port mismatch (service targets port 9999, but pod exposes 80)
# Use this to test the Service debugging features in KubeDiagnose

---
# A working pod with specific labels
apiVersion: v1
kind: Pod
metadata:
  name: backend-pod
  namespace: default
  labels:
    app: backend
    version: v1
spec:
  containers:
    - name: nginx
      image: nginx:alpine
      ports:
        - containerPort: 80
          name: http
      resources:
        limits:
          memory: "128Mi"
          cpu: "100m"
        requests:
          memory: "64Mi"
          cpu: "50m"

---
# Service with WRONG selector (doesn't match the pod above)
# The pod has app=backend, but service selects app=frontend
apiVersion: v1
kind: Service
metadata:
  name: bad-selector-service
  namespace: default
  labels:
    scenario: selector-mismatch
spec:
  selector:
    app: frontend  # WRONG! Pod has app=backend
  ports:
    - protocol: TCP
      port: 80
      targetPort: 80
  type: ClusterIP

---
# Service with WRONG targetPort (pod exposes 80, service targets 9999)
apiVersion: v1
kind: Service
metadata:
  name: bad-port-service
  namespace: default
  labels:
    scenario: port-mismatch
spec:
  selector:
    app: backend  # Correct selector
    version: v1
  ports:
    - protocol: TCP
      port: 80
      targetPort: 9999  # WRONG! Pod container exposes port 80, not 9999
  type: ClusterIP

---
# Service with no matching pods at all
apiVersion: v1
kind: Service
metadata:
  name: no-endpoints-service
  namespace: default
  labels:
    scenario: no-endpoints
spec:
  selector:
    app: ghost-app  # No pod with this label exists
  ports:
    - protocol: TCP
      port: 8080
      targetPort: 8080
  type: ClusterIP
